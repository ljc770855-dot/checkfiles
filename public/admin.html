<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>天眼查 - 管理员面板</title>
    <!-- 引入 Tailwind CSS 框架 -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        'admin-bg': '#f4f7fa',
                        'admin-sidebar': '#1e293b', // slate-800
                        'admin-primary': '#3b82f6', // blue-500
                    }
                }
            }
        }
    </script>
    <style>
        /* 隐藏所有内容区域，只显示激活的 */
        .admin-content-view { display: none; }
        .active-view { display: block; }
        
        /* 侧边栏激活链接样式 */
        .sidebar-link.active {
            background-color: #3b82f6; /* blue-500 */
            color: white;
            font-weight: 600;
        }
        
        /* 确保页面不溢出 */
        body { overflow-x: hidden; }

        /* PC模式下侧边栏的平滑宽度过渡 */
        #admin-sidebar {
            transition: width 0.3s ease-in-out, transform 0.3s ease-in-out, padding 0.3s ease-in-out;
        }
        /* 隐藏侧边栏的文本内容，以便在收起时保持 w-0 纯净 */
        .sidebar-content-hide {
            opacity: 0;
            transition: opacity 0.1s;
            white-space: nowrap;
        }
        .sidebar-content-show {
            opacity: 1;
            transition: opacity 0.1s 0.2s; /* 延迟显示，等待宽度动画完成 */
        }
    </style>
</head>
<!-- 在PC端（lg及以上）是flex-row，在移动端是flex-col -->
<body class="bg-admin-bg min-h-screen font-sans flex flex-col lg:flex-row">
    
    <!-- 移动端顶部 Header (lg: breakpoint 以下可见) -->
    <header id="mobile-header" class="lg:hidden bg-admin-sidebar text-white p-4 flex justify-between items-center sticky top-0 z-40 shadow-lg">
        <h1 class="text-xl font-bold flex items-center">
            <!-- 模拟 Logo -->
            <svg class="w-5 h-5 mr-2 text-red-400" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
            </svg>
            天眼查 管理
        </h1>
        <!-- 移动端汉堡菜单按钮 -->
        <button id="menu-toggle-btn" onclick="toggleSidebar()" class="p-2 rounded-lg hover:bg-slate-700 transition">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </header>

    <!-- 1. 左侧导航栏 (Sidebar) -->
    <!-- PC端默认 w-64，移动端默认隐藏 -->
    <aside id="admin-sidebar" 
           class="w-64 lg:w-64 bg-admin-sidebar text-white min-h-screen fixed lg:relative z-40 
                  transform -translate-x-full lg:translate-x-0 
                  shadow-xl lg:shadow-none flex-shrink-0">
        
        <div id="sidebar-content" class="h-full flex flex-col sidebar-content-show">
            <!-- PC端标题/Logo -->
            <div class="p-6 border-b border-slate-700">
                <h1 class="text-2xl font-bold flex items-center">
                    <svg class="w-6 h-6 mr-2 text-red-400" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/>
                    </svg>
                    天眼查 管理
                </h1>
            </div>
            
            <nav class="p-4 space-y-1 flex-grow">
                <a href="#" onclick="navigateAdmin('dashboard')" id="nav-dashboard"
                   class="sidebar-link active block p-3 rounded-lg transition duration-150 hover:bg-slate-700">
                    仪表板
                </a>
                <a href="#" onclick="navigateAdmin('orders')" id="nav-orders"
                   class="sidebar-link block p-3 rounded-lg transition duration-150 hover:bg-slate-700">
                    订单管理
                </a>
                <a href="#" onclick="navigateAdmin('users')" id="nav-users"
                   class="sidebar-link block p-3 rounded-lg transition duration-150 hover:bg-slate-700">
                    用户管理
                </a>
                <a href="#" onclick="navigateAdmin('content')" id="nav-content"
                   class="sidebar-link block p-3 rounded-lg transition duration-150 hover:bg-slate-700">
                    内容配置
                </a>
            </nav>
            
            <div class="p-4 border-t border-slate-700">
                <button onclick="showNotification('模拟登出', 'info')" class="w-full py-2 bg-slate-700 text-slate-300 rounded-lg hover:bg-red-600 hover:text-white transition duration-150">
                    安全退出
                </button>
            </div>
        </div>
    </aside>
    
    <!-- 移动端侧边栏打开时的遮罩层 -->
    <div id="sidebar-overlay" onclick="toggleSidebar()" class="fixed inset-0 bg-black opacity-0 transition-opacity duration-300 z-30 hidden lg:hidden"></div>

    <!-- 2. 右侧主内容区域 -->
    <main class="flex-grow p-4 sm:p-8 w-full">
        
        <!-- PC Toggle Button and Main Title -->
        <div class="flex justify-between items-center mb-6 text-gray-800">
            <h1 id="main-title" class="text-3xl font-bold"></h1>
            <!-- PC Toggle Button: Default state is open, so icon points left -->
            <button id="pc-toggle-btn" onclick="toggleSidebar()" 
                    class="hidden lg:block p-2 rounded-full text-gray-600 bg-white shadow-md hover:bg-gray-100 transition duration-150">
                <svg id="sidebar-toggle-icon" class="w-6 h-6 transform transition-transform duration-300" 
                     fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                </svg>
            </button>
        </div>
        
        <!-- 2.1 仪表板 (Dashboard) -->
        <div id="dashboard" class="admin-content-view active-view">
            <!-- 统计卡片：响应式布局 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-admin-primary">
                    <p class="text-sm font-medium text-gray-500">总订单数</p>
                    <p class="text-4xl font-extrabold text-gray-900 mt-1" id="total-orders-stat">425</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-yellow-500">
                    <p class="text-sm font-medium text-gray-500">待处理订单</p>
                    <p class="text-4xl font-extrabold text-gray-900 mt-1" id="pending-orders-stat">15</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-green-500">
                    <p class="text-sm font-medium text-gray-500">本月营收 (¥)</p>
                    <p class="text-4xl font-extrabold text-gray-900 mt-1" id="monthly-revenue-stat">65,800</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg border-l-4 border-purple-500">
                    <p class="text-sm font-medium text-gray-500">活跃用户</p>
                    <p class="text-4xl font-extrabold text-gray-900 mt-1" id="active-users-stat">98</p>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl shadow-lg">
                <h2 class="text-xl font-semibold mb-4 border-b pb-2">最近的活动</h2>
                <ul class="space-y-3 text-sm text-gray-600">
                    <li class="flex justify-between"><span>[订单] #C425: 商业调查 已进入处理中</span><span class="text-xs text-gray-400">2分钟前</span></li>
                    <li class="flex justify-between"><span>[用户] user@example.com 完成注册</span><span class="text-xs text-gray-400">1小时前</span></li>
                    <li class="flex justify-between"><span>[订单] #C424: 资产核实 已完成并发邮件</span><span class="text-xs text-gray-400">昨日 15:30</span></li>
                </ul>
            </div>
        </div>
        
        <!-- 2.2 订单管理 (Order Management) -->
        <div id="order-management" class="admin-content-view">
            <div class="bg-white p-4 rounded-xl shadow-lg overflow-x-auto">
                <!-- 确保表格在小屏幕上可水平滚动 -->
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单 ID</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">项目名称</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">客户邮箱</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">状态</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                        </tr>
                    </thead>
                    <tbody id="orders-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- 订单数据将由 JS 插入 -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 2.3 用户管理 (User Management) -->
        <div id="user-management" class="admin-content-view">
            <div class="bg-white p-4 rounded-xl shadow-lg overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">用户 ID</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">注册邮箱</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">订单数量</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">上次登录</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">操作</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body" class="bg-white divide-y divide-gray-200">
                        <!-- 用户数据将由 JS 插入 -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 2.4 内容配置 (Content Management) -->
        <div id="content-management" class="admin-content-view">
            <div class="bg-white p-6 rounded-xl shadow-lg space-y-8">
                
                <!-- 平台简介配置 -->
                <div>
                    <h2 class="text-xl font-semibold mb-3 border-b pb-2">客户端主页简介</h2>
                    <textarea id="platform-intro-admin" rows="4" 
                              class="w-full border border-gray-300 rounded-md p-3 focus:ring-admin-primary focus:border-admin-primary">
我们致力于提供权威、高效的商业及个人信息查询服务。
                    </textarea>
                    <button onclick="savePlatformIntro()" class="mt-3 py-2 px-4 bg-admin-primary text-white font-medium rounded-lg hover:bg-blue-600 transition">
                        保存简介
                    </button>
                </div>
                
                <!-- 服务项目配置 -->
                <div>
                    <h2 class="text-xl font-semibold mb-3 border-b pb-2">服务项目列表</h2>
                    <div id="services-config-list" class="space-y-4">
                        <!-- 服务配置表单将由 JS 插入 -->
                    </div>
                    <button onclick="addServiceForm()" class="mt-4 py-2 px-4 bg-green-500 text-white font-medium rounded-lg hover:bg-green-600 transition">
                        + 添加新服务
                    </button>
                </div>
                
                <div id="content-message" class="hidden p-3 rounded-lg text-sm text-green-700 bg-green-100 border border-green-300"></div>

            </div>
        </div>
        
    </main>

    <!-- 3. 模态框/弹窗 -->
    <div id="order-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="bg-white rounded-xl shadow-2xl w-full max-w-lg p-6 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-4 border-b pb-2">订单详情 - <span id="modal-order-id"></span></h3>
            
            <div class="space-y-3 mb-6 text-sm text-gray-700">
                <p><strong>项目:</strong> <span id="modal-project-name"></span></p>
                <p><strong>客户邮箱:</strong> <span id="modal-client-email"></span></p>
                <p><strong>联系方式:</strong> <span id="modal-client-contact"></span></p>
                <p><strong>备注:</strong> <span id="modal-notes" class="block bg-gray-100 p-2 rounded-md mt-1 whitespace-pre-wrap"></span></p>
                <p><strong>附件:</strong> <span id="modal-attachments" class="text-blue-500 cursor-pointer hover:underline">查看附件 (模拟)</span></p>
            </div>
            
            <div class="mb-4">
                <label for="status-select" class="block text-sm font-medium text-gray-700 mb-1">更新状态:</label>
                <select id="status-select" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-admin-primary focus:border-admin-primary">
                    <option value="等待确认">等待确认</option>
                    <option value="处理中">处理中</option>
                    <option value="已完成">已完成</option>
                    <option value="已取消">已取消</option>
                </select>
            </div>
            
            <div class="flex justify-end space-x-3">
                <button onclick="closeModal('order-modal')" class="py-2 px-4 bg-gray-200 rounded-lg hover:bg-gray-300 transition">关闭</button>
                <button onclick="updateOrderStatus()" id="modal-update-button" 
                        class="py-2 px-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition">保存并更新</button>
            </div>
        </div>
    </div>


    <script>
        // --- 模拟数据存储和状态 ---
        const SIDEBAR_WIDTH_REM = 16; // 16rem = w-64
        let isPcSidebarOpen = true; // PC端默认侧边栏是展开的
        let currentEditingOrderId = null; 
        
        let dummyOrders = [
            { id: 'C425', project: '高精度商业背景调查', email: 'user1@email.com', contact: '138****0001', status: '等待确认', notes: '请着重调查公司法人近期是否有诉讼记录。', attachments: ['auth.pdf', 'id.jpg'], time: '2025-10-02 10:00' },
            { id: 'C424', project: '个人资产核实服务', email: 'client2@email.com', contact: '139****1111', status: '处理中', notes: '加急，三天内出初稿。', attachments: ['req.docx'], time: '2025-10-01 14:12' },
            { id: 'C423', project: '高精度商业背景调查', email: 'vip3@email.com', contact: '188****2222', status: '已完成', notes: '常规订单，已顺利完成。', attachments: [], time: '2025-09-30 09:30' },
        ];

        let dummyUsers = [
            { id: 'U0001', email: 'user1@email.com', orders: 2, lastLogin: '2025-10-02 10:30' },
            { id: 'U0002', email: 'client2@email.com', orders: 5, lastLogin: '2025-10-01 15:00' },
            { id: 'U0003', email: 'vip3@email.com', orders: 15, lastLogin: '2025-10-02 08:00' },
        ];
        
        let dummyServices = [
            { id: 'S1', name: '高精度商业背景调查', price: 999.00 },
            { id: 'S2', name: '个人资产核实服务', price: 1200.00 },
        ];


        // --- 通用提示函数（代替 alert） ---

        /** 通用通知提示（代替 alert） */
        function showNotification(message, type = 'success') {
            const container = document.body;
            let bgColor = 'bg-green-500';
            if (type === 'error') bgColor = 'bg-red-500';
            if (type === 'info') bgColor = 'bg-blue-500';
            
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg text-white shadow-xl ${bgColor} transition-opacity duration-300 z-[9999]`;
            notification.innerText = message;
            
            container.appendChild(notification);
            
            // 自动移除
            setTimeout(() => {
                notification.classList.add('opacity-0');
                notification.addEventListener('transitionend', () => notification.remove());
            }, 3000);
        }

        /** 打开模态框 */
        function openModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
            document.getElementById(modalId).classList.add('flex');
        }

        /** 关闭模态框 */
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
            document.getElementById(modalId).classList.remove('flex');
        }


        // --- 响应式和导航路由 ---

        /** 切换侧边栏状态（PC折叠/展开；移动端滑入/滑出） */
        function toggleSidebar() {
            const sidebar = document.getElementById('admin-sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const toggleIcon = document.getElementById('sidebar-toggle-icon');
            const sidebarContent = document.getElementById('sidebar-content');

            if (window.innerWidth >= 1024) { // PC Mode (lg)
                
                isPcSidebarOpen = !isPcSidebarOpen;
                
                if (isPcSidebarOpen) {
                    // EXPAND: w-64 (16rem)
                    sidebar.style.width = `${SIDEBAR_WIDTH_REM}rem`;
                    sidebar.style.paddingLeft = '1.5rem'; // Reapply padding, adjust if needed (p-6 translates to 1.5rem)
                    sidebar.style.paddingRight = '1.5rem';
                    toggleIcon.style.transform = 'rotate(0deg)'; 
                    
                    // 等待宽度动画完成，再显示内容
                    setTimeout(() => {
                        sidebarContent.classList.remove('sidebar-content-hide');
                        sidebarContent.classList.add('sidebar-content-show');
                    }, 100); 

                } else {
                    // COLLAPSE: w-0
                    sidebar.style.width = '0rem';
                    sidebar.style.padding = '0'; // 移除 padding
                    toggleIcon.style.transform = 'rotate(180deg)'; 
                    
                    sidebarContent.classList.add('sidebar-content-hide');
                    sidebarContent.classList.remove('sidebar-content-show');
                }

            } else {
                // Mobile Mode: Toggle slide-in/out and overlay
                sidebar.classList.toggle('-translate-x-full');
                overlay.classList.toggle('hidden');
                overlay.classList.toggle('opacity-50');
            }
        }

        /** 切换管理员视图 */
        function navigateAdmin(viewId) {
            // 隐藏所有视图
            document.querySelectorAll('.admin-content-view').forEach(el => {
                el.classList.remove('active-view');
            });

            // 显示目标视图
            const target = document.getElementById(viewId);
            if (target) {
                target.classList.add('active-view');
                // 更新主标题
                const titleText = (
                    viewId === 'dashboard' ? '仪表板概览' :
                    viewId === 'orders' ? '订单管理' :
                    viewId === 'users' ? '用户管理' :
                    viewId === 'content' ? '内容配置' : '管理面板'
                );
                document.getElementById('main-title').innerText = titleText;
            }

            // 更新导航栏激活状态
            document.querySelectorAll('.sidebar-link').forEach(link => {
                link.classList.remove('active');
            });
            document.getElementById(`nav-${viewId}`).classList.add('active');

            // 移动端：导航后自动关闭侧边栏
            if (window.innerWidth < 1024) {
                const sidebar = document.getElementById('admin-sidebar');
                if (!sidebar.classList.contains('-translate-x-full')) {
                    toggleSidebar();
                }
            }

            // 针对特定视图加载数据
            if (viewId === 'orders') {
                loadOrdersTable();
            } else if (viewId === 'users') {
                loadUsersTable();
            } else if (viewId === 'content') {
                loadServicesConfig();
            }
        }


        // --- 订单详情和更新逻辑 ---

        /** 根据状态获取 Tailwind 样式 */
        function getStatusBadge(status) {
            let colorClass = '';
            switch (status) {
                case '等待确认': colorClass = 'bg-blue-200 text-blue-800'; break;
                case '处理中': colorClass = 'bg-yellow-200 text-yellow-800'; break;
                case '已完成': colorClass = 'bg-green-200 text-green-800'; break;
                case '已取消': colorClass = 'bg-red-200 text-red-800'; break;
                default: colorClass = 'bg-gray-200 text-gray-800';
            }
            return `<span class="px-3 py-1 text-xs font-bold rounded-full ${colorClass}">${status}</span>`;
        }
        
        /** 加载订单表格数据 */
        function loadOrdersTable() {
            const tableBody = document.getElementById('orders-table-body');
            tableBody.innerHTML = '';
            dummyOrders.forEach(order => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-100 transition duration-100';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${order.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.project}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${order.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${getStatusBadge(order.status)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="showOrderDetails('${order.id}')" class="text-admin-primary hover:text-blue-700">
                            查看/更新
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        /** 加载用户表格数据 */
        function loadUsersTable() {
            const tableBody = document.getElementById('users-table-body');
            tableBody.innerHTML = '';
            dummyUsers.forEach(user => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-100 transition duration-100';
                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${user.id}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.email}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.orders}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${user.lastLogin}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                        <button onclick="showNotification('模拟封禁用户: ${user.email}', 'error')" class="text-red-600 hover:text-red-800">
                            封禁
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        /** 加载服务配置表单 */
        function loadServicesConfig() {
            const listContainer = document.getElementById('services-config-list');
            listContainer.innerHTML = '';
            
            dummyServices.forEach((service) => {
                const form = document.createElement('div');
                form.className = 'p-4 border border-gray-200 rounded-lg bg-gray-50 space-y-2';
                form.setAttribute('data-service-id', service.id);
                form.innerHTML = `
                    <div class="flex justify-between items-center">
                        <h4 class="font-bold text-lg text-admin-primary">${service.name}</h4>
                        <button onclick="removeServiceForm('${service.id}')" class="text-red-500 hover:text-red-700 text-sm">删除</button>
                    </div>
                    <label class="block text-sm font-medium text-gray-700">项目名称</label>
                    <input type="text" value="${service.name}" data-field="name" class="w-full p-2 border rounded-md">
                    <label class="block text-sm font-medium text-gray-700">价格 (¥)</label>
                    <input type="number" value="${service.price}" data-field="price" class="w-full p-2 border rounded-md">
                `;
                listContainer.appendChild(form);
            });
        }
        
        /** 显示订单详情（在模态框中） */
        function showOrderDetails(orderId) {
            const order = dummyOrders.find(o => o.id === orderId);
            if (!order) return;
            
            currentEditingOrderId = orderId;

            document.getElementById('modal-order-id').innerText = order.id;
            document.getElementById('modal-project-name').innerText = order.project;
            document.getElementById('modal-client-email').innerText = order.email;
            document.getElementById('modal-client-contact').innerText = order.contact;
            document.getElementById('modal-notes').innerText = order.notes || '无';
            document.getElementById('status-select').value = order.status;
            
            const attachmentsEl = document.getElementById('modal-attachments');
            attachmentsEl.innerHTML = order.attachments.length > 0 ? 
                `附件 (${order.attachments.length})` : '无附件';
            attachmentsEl.onclick = () => {
                if (order.attachments.length > 0) {
                    showNotification(`模拟下载附件：${order.attachments.join(', ')}`, 'info');
                }
            };

            openModal('order-modal');
        }

        /** 模拟更新订单状态 */
        function updateOrderStatus() {
            if (!currentEditingOrderId) return;

            const newStatus = document.getElementById('status-select').value;
            const orderIndex = dummyOrders.findIndex(o => o.id === currentEditingOrderId);
            
            if (orderIndex !== -1) {
                dummyOrders[orderIndex].status = newStatus;
                loadOrdersTable();
                showNotification(`订单 ${currentEditingOrderId} 状态已更新为: ${newStatus}`, 'success');
                closeModal('order-modal');
            }
        }
        
        // --- 内容配置逻辑 ---
        
        function savePlatformIntro() {
            const introText = document.getElementById('platform-intro-admin').value;
            // 这里可以添加保存到后端的逻辑
            showNotification('平台简介已成功更新！', 'success');
        }
        
        function addServiceForm() {
            const newId = 'Temp' + Math.floor(Math.random() * 1000);
            const listContainer = document.getElementById('services-config-list');

            const form = document.createElement('div');
            form.className = 'p-4 border-2 border-dashed border-admin-primary rounded-lg bg-blue-50 space-y-2';
            form.setAttribute('data-service-id', newId);
            form.innerHTML = `
                <div class="flex justify-between items-center">
                    <h4 class="font-bold text-lg text-admin-primary">新服务 (待保存)</h4>
                    <button onclick="removeServiceForm('${newId}')" class="text-red-500 hover:text-red-700 text-sm">删除</button>
                </div>
                <label class="block text-sm font-medium text-gray-700">项目名称</label>
                <input type="text" value="新项目名称" data-field="name" class="w-full p-2 border rounded-md">
                <label class="block text-sm font-medium text-gray-700">价格 (¥)</label>
                <input type="number" value="0.00" data-field="price" class="w-full p-2 border rounded-md">
            `;
            listContainer.appendChild(form);
            showNotification('已添加新服务表单，请编辑并保存。', 'info');
        }

        function removeServiceForm(id) {
            const element = document.querySelector(`[data-service-id="${id}"]`);
            if (element) {
                element.remove();
                dummyServices = dummyServices.filter(s => s.id !== id);
                showNotification(`服务 ${id} 已被移除 (仅模拟前端操作)。`, 'error');
            }
        }


        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            const sidebar = document.getElementById('admin-sidebar');
            // PC端设置初始宽度，以便于后续的CSS过渡动画
            if (window.innerWidth >= 1024) { 
                sidebar.style.width = `${SIDEBAR_WIDTH_REM}rem`;
            }
            // 默认导航到仪表板
            navigateAdmin('dashboard');
        });
    </script>
</body>
</html>
